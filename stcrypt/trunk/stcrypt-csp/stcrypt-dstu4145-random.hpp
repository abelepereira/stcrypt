//================================================================================================================================================
// FILE: stcrypt-dstu4145-random.h
// (c) GIE 2010-01-03  04:04
//
//================================================================================================================================================
#ifndef H_GUARD_STCRYPT_DSTU4145_RANDOM_2010_01_03_04_04
#define H_GUARD_STCRYPT_DSTU4145_RANDOM_2010_01_03_04_04
//================================================================================================================================================
#pragma once
//================================================================================================================================================
#include "stcrypt-gost3411-impl.hpp"
#include "stcrypt-cryptolib.hpp"
#include "stcrypt-exceptions.hpp"

#include "boost/noncopyable.hpp"

#include <vector>
//================================================================================================================================================
namespace stcrypt {

	struct dstu4145_random_t
		: boost::noncopyable
	{

		dstu4145_random_t();
		dstu4145_random_t(BYTE const * const seed_bonus, size_t const seed_bonus_size);
		~dstu4145_random_t();

		void gen_random(BYTE * buffer, size_t const buffer_size);

	private:	
		void init_(BYTE const * const seed_bonus, size_t const seed_bonus_size);
	private:
		cryptolib_context_t		m_ctx;
	};

}
//================================================================================================================================================
#endif
//================================================================================================================================================
