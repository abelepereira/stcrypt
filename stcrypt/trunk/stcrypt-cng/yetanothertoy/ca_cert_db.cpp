//================================================================================================================================================
// FILE: ca_cert_db.cpp
// (c) GIE 2011-02-09  20:00
//
//================================================================================================================================================
#include "stdafx.h"
//================================================================================================================================================
#include "ca_cert_db_if.hpp"
//================================================================================================================================================
#include "../../stcrypt-cng/stcrypt-exceptions.hpp"

#include "cert_db.hpp"

#include <boost/make_shared.hpp>
#include <boost/filesystem.hpp>
//================================================================================================================================================
namespace toy_ca {

	namespace {

		struct ca_cert_db_impl : ca_cert_db
		{

			ca_cert_db_impl(boost::filesystem::wpath const& db_root)
				: m_cert_db( db_root / L"certs" )
			{}

		private:
			toy::cert_db	m_cert_db;
		};

	}

	boost::shared_ptr<ca_cert_db> initialize_ca_cert_db(boost::filesystem::wpath const& db_root){

		return boost::make_shared<ca_cert_db_impl>(db_root);

	}

}
//================================================================================================================================================
